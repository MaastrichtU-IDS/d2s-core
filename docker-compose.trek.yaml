version: "3"

services:

  virtuoso:
    environment:
      - VIRTUAL_HOST=virtuoso.137.120.31.102.nip.io # for IDS node2
      - VIRTUAL_PORT=8890
      - DBA_PASSWORD=dba
      - VIRT_Parameters_DirsAllowed=., /usr/local/virtuoso-opensource/share/virtuoso/vad, /usr/local/virtuoso-opensource/var/lib/virtuoso/db
      - VIRT_SPARQL_ResultSetMaxRows=999999999999999999
      - VIRT_SPARQL_MaxQueryCostEstimationTime=0
      - VIRT_SPARQL_MaxQueryExecutionTime=14400
      - VIRT_Parameters_Timeout=7200
      - VIRT_Parameters_NumberOfBuffers=10900000
      - VIRT_Parameters_MaxDirtyBuffers=8000000
      # - VIRT_Parameters_MaxClientConnections		= 10 # Better to reduce if a lot of big requests
      # - VIRT_Parameters_NumberOfBuffers = 5450000
      # - VIRT_Parameters_MaxDirtyBuffers = 4000000
      # - VIRT_SPARQL_DefaultQuery=select distinct ?Concept where {[] a ?Concept} LIMIT 100
      # - VIRT_VDB_VDBDisconnectTimeout=7200000
      # - VIRT_Client_SQL_QUERY_TIMEOUT=14400000
      # - VIRT_CLient_SQL_TXN_TIMEOUT=14400000


  drill:
    environment:
      - VIRTUAL_HOST=drill.137.120.31.102.nip.io  # node2
      - VIRTUAL_PORT=8047

  # graphdb:
    # image: ontotext/graphdb:9.1.1-ee
    # environment:
    #   - VIRTUAL_HOST=d2s-graphdb.137.120.31.101.nip.io

  # blazegraph:
    # environment:
    #   # Work for Ubuntu ($UID=1000 and 1000 in $GROUPS)
    #   - BLAZEGRAPH_UID=${UID}
    #   - BLAZEGRAPH_GID=${GID}
    #   - VIRTUAL_HOST=d2s-blazegraph.137.120.31.101.nip.io

  # comunica:

  api:
    environment: 
      - ENDPOINT=http://graphdb:7200/repositories/trek
      - VIRTUAL_HOST=api.137.120.31.102.nip.io
    
  filebrowser:
    environment:
      - VIRTUAL_HOST=download.137.120.31.102.nip.io
    #   - VIRTUAL_HOST=download.semanticscience.org
    #   - LETSENCRYPT_HOST=download.semanticscience.org

  browse-translator-trek:
    environment:
      - VIRTUAL_HOST=trek.137.120.31.102.nip.io

